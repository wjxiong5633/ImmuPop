[{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 ImmuPop authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Weijia Xiong. Maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Xiong W (2025). ImmuPop: Estimating Population Immunity Using Individual Antibody Titers. R package version 0.1.0.","code":"@Manual{,   title = {ImmuPop: Estimating Population Immunity Using Individual Antibody Titers},   author = {Weijia Xiong},   year = {2025},   note = {R package version 0.1.0}, }"},{"path":"/index.html","id":"immupop","dir":"","previous_headings":"","what":"Estimating Population Immunity Using Individual Antibody Titers","title":"Estimating Population Immunity Using Individual Antibody Titers","text":"ImmuPop R package designed estimate key population immunity metrics individual serology data. package provides following estimators: Geometric Mean Titer (GMT) Proportion Non-Naïve Individuals Proportion Population Immune Relative Reduction Reproductive Number (R0) estimators help assess population immunity predict impact infectious diseases.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Estimating Population Immunity Using Individual Antibody Titers","text":"can install development version ImmuPop GitHub:","code":"# install.packages(\"devtools\") devtools::install_github(\"wjxiong5633/ImmuPop\")"},{"path":[]},{"path":"/index.html","id":"load-required-libraries","dir":"","previous_headings":"Example Usage","what":"Load Required Libraries","title":"Estimating Population Immunity Using Individual Antibody Titers","text":"using package, load ImmuPop required libraries:","code":"library(ImmuPop) library(dplyr) library(rlist) library(MCMCpack)"},{"path":"/index.html","id":"load-raw-data","dir":"","previous_headings":"Example Usage","what":"Load Raw Data","title":"Estimating Population Immunity Using Individual Antibody Titers","text":"package includes example data (ImmuPop_raw_data), contains columns time, epi, bsl, age, raw_titer.","code":"data(\"ImmuPop_raw_data\") knitr::kable(ImmuPop_raw_data, digits = 3, row.names = F)"},{"path":"/index.html","id":"data-preparation","dir":"","previous_headings":"Example Usage","what":"Data Preparation","title":"Estimating Population Immunity Using Individual Antibody Titers","text":"Use generate_data() function preprocess raw data categorize age groups:","code":"data_example <- generate_data(ImmuPop_raw_data, cut_age = c(0, 18, 50, 100)) knitr::kable(data_example, digits = 3, row.names = F)"},{"path":[]},{"path":"/index.html","id":"age-proportions","dir":"","previous_headings":"Example Usage > Define Population Parameters","what":"Age Proportions","title":"Estimating Population Immunity Using Individual Antibody Titers","text":"Define age group proportions based cut_age parameter:","code":"age_prop <- c(0.2, 0.4, 0.4) # Adjust proportions according to your population"},{"path":"/index.html","id":"contact-matrix","dir":"","previous_headings":"Example Usage > Define Population Parameters","what":"Contact Matrix","title":"Estimating Population Immunity Using Individual Antibody Titers","text":"Define contact matrix can use socialmixr package generate contact matrix:","code":"contact_matrix <- matrix(   c(22, 16, 15, 24, 28, 30, 18, 32, 35),   nrow = 3, byrow = TRUE ) library(socialmixr) data(polymod) contact_matrix(polymod, countries = \"United Kingdom\", age.limits = c(0, 1, 5, 15)) #> Removing participants that have contacts without age information. To change this behaviour, set the 'missing.contact.age' option #> $matrix #>          contact.age.group #> age.group      [0,1)     [1,5)   [5,15)      15+ #>    [0,1)  0.40000000 0.8000000 1.266667 5.933333 #>    [1,5)  0.11250000 1.9375000 1.462500 5.450000 #>    [5,15) 0.02450980 0.5049020 7.946078 6.215686 #>    15+    0.03230337 0.3581461 1.290730 9.594101 #>  #> $participants #>    age.group participants proportion #>       <char>        <int>      <num> #> 1:     [0,1)           15 0.01483680 #> 2:     [1,5)           80 0.07912957 #> 3:    [5,15)          204 0.20178042 #> 4:       15+          712 0.70425321"},{"path":"/index.html","id":"protection-effects","dir":"","previous_headings":"Example Usage > Define Population Parameters","what":"Protection Effects","title":"Estimating Population Immunity Using Individual Antibody Titers","text":"Define protection effects children adults based HAI titer levels (e.g. 40% HI associated 50% protection):","code":"# each item of vector represent the protection of each titer level (e.g. 1-10 titer level) protect_c <- c(0.1, 0.2, 0.3, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8) protect_a <- c(0.1, 0.2, 0.3, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8)"},{"path":[]},{"path":"/index.html","id":"estimating-immunity-at-a-specific-time-point","dir":"","previous_headings":"Immunity Estimation","what":"Estimating Immunity at a Specific Time Point","title":"Estimating Population Immunity Using Individual Antibody Titers","text":"estimate immunity specific time point (e.g., time = 200):","code":"data_example_t <- data_example %>% filter(time == 200)  result <- ImmuPop_timet_est(   df = data_example_t,   protect_c = protect_c,   protect_a = protect_a,   age_prop = age_prop,   contact_matrix = contact_matrix,   sim_num = 100 )  knitr::kable(result, digits = 3, row.names = F)"},{"path":"/index.html","id":"estimating-immunity-across-all-time-points","dir":"","previous_headings":"Immunity Estimation","what":"Estimating Immunity Across All Time Points","title":"Estimating Population Immunity Using Individual Antibody Titers","text":"estimate immunity across time points:","code":"est_res_all <- ImmuPop_allt_est(   df_long = data_example,   protect_c = protect_c,   protect_a = protect_a,   age_prop = age_prop,   contact_matrix = contact_matrix,   sim_num = 100 )  knitr::kable(est_res_all, digits = 3, row.names = F)"},{"path":"/index.html","id":"estimating-baseline-population-immunity-pre-epidemic","dir":"","previous_headings":"Immunity Estimation","what":"Estimating Baseline Population Immunity (Pre-Epidemic)","title":"Estimating Population Immunity Using Individual Antibody Titers","text":"estimate baseline population immunity epidemic:","code":"df_long_bsl <- data_example %>% filter(bsl == \"yes\")  est_res_bsl <- ImmuPop_bsl_est(   df = df_long_bsl,   protect_c = protect_c,   protect_a = protect_a,   age_prop = age_prop,   contact_matrix = contact_matrix,   sim_num = 100 )  knitr::kable(est_res_bsl, digits = 3, row.names = F)"},{"path":"/reference/ImmuPop_allt_est.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Immunity Across All Time Points — ImmuPop_allt_est","title":"Estimate Immunity Across All Time Points — ImmuPop_allt_est","text":"function estimates immunity time point using `ImmuPop_timet_est` returns results.","code":""},{"path":"/reference/ImmuPop_allt_est.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Immunity Across All Time Points — ImmuPop_allt_est","text":"df_long dataframe containing data time points. protect_c Numeric vector indicating protection effect children. protect_a Numeric vector indicating protection effect adults. agep_prop Numeric vector age group proportions population. contact_matrix Numeric matrix contact rates age groups. sim_num number bootstrap simulations run (default = 500).","code":""},{"path":"/reference/ImmuPop_allt_est.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Immunity Across All Time Points — ImmuPop_allt_est","text":"dataframe immunity estimates time point, including median 95","code":""},{"path":"/reference/ImmuPop_bsl_est.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Immunity at the Baseline Period — ImmuPop_bsl_est","title":"Estimate Immunity at the Baseline Period — ImmuPop_bsl_est","text":"function estimates immunity baseline period different epidemic (`epi`) circulating virus groups.","code":""},{"path":"/reference/ImmuPop_bsl_est.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Immunity at the Baseline Period — ImmuPop_bsl_est","text":"df_long_bsl dataframe containing baseline data (pre-epidemic), including epidemic information `epi`. protect_c Numeric vector indicating protection effect children. protect_a Numeric vector indicating protection effect adults. age_prop Numeric vector age group proportions population. contact_matrix Numeric matrix contact rates age groups. sim_num number bootstrap simulations run (default = 500).","code":""},{"path":"/reference/ImmuPop_bsl_est.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Immunity at the Baseline Period — ImmuPop_bsl_est","text":"dataframe baseline immunity estimates, including median 95","code":""},{"path":"/reference/ImmuPop_raw_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Example Data for Baseline Immunity — ImmuPop_raw_data","title":"Example Data for Baseline Immunity — ImmuPop_raw_data","text":"data frame contains example data baseline immunity estimation. includes information time points, baseline status, age groups, raw titers.","code":""},{"path":"/reference/ImmuPop_raw_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example Data for Baseline Immunity — ImmuPop_raw_data","text":"","code":"ImmuPop_raw_data"},{"path":"/reference/ImmuPop_raw_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example Data for Baseline Immunity — ImmuPop_raw_data","text":"data frame columns: uid Numeric, subject id. time Numeric, representing time point. epi Character, epidemics bsl Character, indicating baseline status (\"yes\" \"\"). raw_titer Numeric, raw titer values immunity estimation. age Numeric, age subject.","code":""},{"path":"/reference/ImmuPop_timet_est.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Population Immunity, Reduction in R0, GMT, and Proportion of Non-Naive Individuals — ImmuPop_timet_est","title":"Estimate Population Immunity, Reduction in R0, GMT, and Proportion of Non-Naive Individuals — ImmuPop_timet_est","text":"function estimates population immunity, relative reduction transmissibility (R0), geometric mean titer (GMT), proportion individuals HI > 5 using bootstrap sampling MCMC methods. considers multiple age groups various parameters related immunity.","code":""},{"path":"/reference/ImmuPop_timet_est.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Population Immunity, Reduction in R0, GMT, and Proportion of Non-Naive Individuals — ImmuPop_timet_est","text":"","code":"ImmuPop_timet_est(   df,   protect_c,   protect_a,   age_prop,   contact_matrix,   sim_num = 500 )"},{"path":"/reference/ImmuPop_timet_est.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Population Immunity, Reduction in R0, GMT, and Proportion of Non-Naive Individuals — ImmuPop_timet_est","text":"df Data frame containing individual data, including age group raw titer values. protect_c Numeric vector protection effect children. protect_a Numeric vector protection effect adults. age_prop Numeric vector representing age group proportions population. contact_matrix Numeric matrix contact frequencies age groups. sim_num Number bootstrap simulations (default = 500).","code":""},{"path":"/reference/ImmuPop_timet_est.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Population Immunity, Reduction in R0, GMT, and Proportion of Non-Naive Individuals — ImmuPop_timet_est","text":"dataframe baseline immunity estimates, including median 95","code":""},{"path":"/reference/ImmuPop_timet_est.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Population Immunity, Reduction in R0, GMT, and Proportion of Non-Naive Individuals — ImmuPop_timet_est","text":"","code":"# Example usage of ImmuPop_timet_est data(\"ImmuPop_raw_data\") data_example <- generate_data(ImmuPop_raw_data, cut_age = c(0, 18, 50, 100))  # Define age group proportions age_prop <- c(0.2, 0.4, 0.4)  # Define contact matrix contact_matrix <- matrix(c(22, 16, 15, 24, 28, 30, 18, 32, 35), nrow = 3, byrow = TRUE)  # Define protection effects for children and adults protect_c <- c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.95) protect_a <- c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.95)  # Data at a specific time point (e.g., time == 15) data_example_t <- data_example[data_example$time == 15, ]  # Run the estimation function result <- ImmuPop_timet_est(   df = data_example_t,   protect_c = protect_c,   protect_a = protect_a,   age_prop = age_prop,   contact_matrix = contact_matrix,   sim_num = 100 ) #> Error in rep.default(unique(df$agegp1), as.numeric(table(df$agegp1))): invalid 'times' argument  # Print the result print(result) #> Error: object 'result' not found"},{"path":"/reference/age_prop.html","id":null,"dir":"Reference","previous_headings":"","what":"Age Proportions in the Population — age_prop","title":"Age Proportions in the Population — age_prop","text":"vector representing proportion individuals age group population. used calculating immunity estimates children adults.","code":""},{"path":"/reference/age_prop.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Age Proportions in the Population — age_prop","text":"","code":"age_prop"},{"path":"/reference/age_prop.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Age Proportions in the Population — age_prop","text":"numeric vector length p, representing age group proportions.","code":""},{"path":"/reference/contact_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Contact Matrix Between Age Groups — contact_matrix","title":"Contact Matrix Between Age Groups — contact_matrix","text":"matrix representing contact rates different age groups population. matrix used estimate population immunity disease transmission dynamics.","code":""},{"path":"/reference/contact_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Contact Matrix Between Age Groups — contact_matrix","text":"","code":"contact_matrix"},{"path":"/reference/contact_matrix.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Contact Matrix Between Age Groups — contact_matrix","text":"numeric matrix dimensions [p x p] rows columns represent age groups.","code":""},{"path":"/reference/fill_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Fill a new matrix with values from an original matrix based on matching column This function creates a new matrix of zeros with specified number of rows and columns, then fills it with values from the original matrix based on matching column — fill_matrix","title":"Fill a new matrix with values from an original matrix based on matching column This function creates a new matrix of zeros with specified number of rows and columns, then fills it with values from the original matrix based on matching column — fill_matrix","text":"Fill new matrix values original matrix based matching column function creates new matrix zeros specified number rows columns, fills values original matrix based matching column","code":""},{"path":"/reference/fill_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fill a new matrix with values from an original matrix based on matching column This function creates a new matrix of zeros with specified number of rows and columns, then fills it with values from the original matrix based on matching column — fill_matrix","text":"","code":"fill_matrix(nrow, ncol, original_matrix)"},{"path":"/reference/fill_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fill a new matrix with values from an original matrix based on matching column This function creates a new matrix of zeros with specified number of rows and columns, then fills it with values from the original matrix based on matching column — fill_matrix","text":"nrow integer specifying number rows new matrix. ncol integer specifying number columns new matrix. original_matrix matrix whose values transferred new matrix.","code":""},{"path":"/reference/fill_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fill a new matrix with values from an original matrix based on matching column This function creates a new matrix of zeros with specified number of rows and columns, then fills it with values from the original matrix based on matching column — fill_matrix","text":"matrix values original matrix placed matching columns.","code":""},{"path":"/reference/generate_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Example Data from Raw Immunity Data — generate_data","title":"Generate Example Data from Raw Immunity Data — generate_data","text":"function takes raw immunity data (including individual age raw titer values), generates data frame additional columns: age group titer level. age group categorized based provided `cut_age` vector. titer level calculated using formula `log2(raw_titer/5) + 1`.","code":""},{"path":"/reference/generate_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Example Data from Raw Immunity Data — generate_data","text":"ImmuPop_raw_data data frame containing individual raw data, must : - `age`: individual age - `raw_titer`: raw titer values. cut_age numeric vector indicating breakpoints categorize ages. example, `cut_age = c(0, 18, 60, 100)` create following age groups: - [0, 18), [18, 60), [60, 100).","code":""},{"path":"/reference/generate_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Example Data from Raw Immunity Data — generate_data","text":"data frame containing following columns:   - `agegp1`: age group based cut points `cut_age`.   - `titer_level`: log2 transformed titer level calculated `log2(raw_titer / 5) + 1`.","code":""},{"path":"/reference/generate_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Example Data from Raw Immunity Data — generate_data","text":"","code":"# Example usage of generate_data with a vector for cut_age raw_data <- data.frame(   age = c(5, 15, 25, 40, 60),   raw_titer = c(10, 50, 80, 100, 200) ) processed_data <- generate_data(raw_data, cut_age = c(0, 18, 60, 100)) print(processed_data) #>   age raw_titer   agegp1 titer_level #> 1   5        10   [0,18)    2.000000 #> 2  15        50   [0,18)    4.321928 #> 3  25        80  [18,60)    5.000000 #> 4  40       100  [18,60)    5.321928 #> 5  60       200 [60,100)    6.321928"},{"path":"/reference/geo_mean.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the geometric mean of titer values — geo_mean","title":"Calculate the geometric mean of titer values — geo_mean","text":"function calculates geometric mean raw titer values.","code":""},{"path":"/reference/geo_mean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the geometric mean of titer values — geo_mean","text":"","code":"geo_mean(raw_titer)"},{"path":"/reference/geo_mean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the geometric mean of titer values — geo_mean","text":"raw_titer numeric vector raw titer values","code":""},{"path":"/reference/geo_mean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the geometric mean of titer values — geo_mean","text":"geometric mean titer values","code":""},{"path":"/reference/protect_a.html","id":null,"dir":"Reference","previous_headings":"","what":"Protection Effect in the Population — protect_a","title":"Protection Effect in the Population — protect_a","text":"vector representing protection effect children adults. used immunity estimation.","code":""},{"path":"/reference/protect_a.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Protection Effect in the Population — protect_a","text":"","code":"protect_a"},{"path":"/reference/protect_a.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Protection Effect in the Population — protect_a","text":"numeric vector length k, represent protection effect k-th antibody titer level, adult.","code":""},{"path":"/reference/protect_c.html","id":null,"dir":"Reference","previous_headings":"","what":"Protection Effect in the Population — protect_c","title":"Protection Effect in the Population — protect_c","text":"vector representing protection effect children adults. used immunity estimation.","code":""},{"path":"/reference/protect_c.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Protection Effect in the Population — protect_c","text":"","code":"protect_c"},{"path":"/reference/protect_c.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Protection Effect in the Population — protect_c","text":"numeric vector length k, represent protection effect k-th antibody titer level, children.","code":""},{"path":"/reference/weighted_gmt.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the weighted geometric mean for the population — weighted_gmt","title":"Calculate the weighted geometric mean for the population — weighted_gmt","text":"function calculates weighted geometric mean across different age groups.","code":""},{"path":"/reference/weighted_gmt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the weighted geometric mean for the population — weighted_gmt","text":"","code":"weighted_gmt(resampled_df, age_prop)"},{"path":"/reference/weighted_gmt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the weighted geometric mean for the population — weighted_gmt","text":"resampled_df dataframe containing raw titer values age group information age_prop vector age group proportions","code":""},{"path":"/reference/weighted_gmt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the weighted geometric mean for the population — weighted_gmt","text":"weighted geometric mean population","code":""},{"path":"/reference/weighted_prop_HImorethan5.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the weighted proportion of individuals with titer more than 5 — weighted_prop_HImorethan5","title":"Calculate the weighted proportion of individuals with titer more than 5 — weighted_prop_HImorethan5","text":"function calculates weighted proportion individuals titer value greater equal 10.","code":""},{"path":"/reference/weighted_prop_HImorethan5.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the weighted proportion of individuals with titer more than 5 — weighted_prop_HImorethan5","text":"","code":"weighted_prop_HImorethan5(resampled_df, age_prop)"},{"path":"/reference/weighted_prop_HImorethan5.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the weighted proportion of individuals with titer more than 5 — weighted_prop_HImorethan5","text":"resampled_df dataframe containing raw titer values age group information age_prop vector age group proportions","code":""},{"path":"/reference/weighted_prop_HImorethan5.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the weighted proportion of individuals with titer more than 5 — weighted_prop_HImorethan5","text":"weighted proportion population","code":""}]
